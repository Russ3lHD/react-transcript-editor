!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.sttJsonAdapter=e():t.sttJsonAdapter=e()}(this,()=>(()=>{"use strict";var t={760:(t,e,r)=>{r.d(e,{A:()=>s});let n=0;const s=(t,e)=>{let r=0;return t.map(t=>{const s=t[e]||"",a={start:parseFloat(t.start)||0,end:parseFloat(t.end)||0,confidence:t.confidence?parseFloat(t.confidence):void 0,text:s,offset:r,length:s.length,key:"entity_".concat(n++)};return r=r+s.length+1,a})}},2432:(t,e,r)=>{function n(t){const e=t&&(t.text||t.word||t.token||t.t||"");return String(e).trim()}r.d(e,{default:()=>s});const s=function(t,e){const{normalizedWords:r,normalizedSegments:s}=function(t,e){let r=Array.isArray(t)?t.slice():[],s=Array.isArray(e)?e.slice():[];return!s.length&&t&&t.segments&&(s=t.segments.slice(),r=[]),r&&0!==r.length||!s.length||s.some(t=>Array.isArray(t.words)&&t.words.length)&&(s=s.map(t=>{const e=t.speaker||t.speaker_label||(void 0!==t.id?"SPK ".concat(t.id):"UKN");return Object.assign({},t,{speaker:e})}),r=s.reduce((t,e)=>{const r=(e.words||[]).map(t=>({start:t.start,end:t.end,text:n(t),_segment:e}));return t.concat(r)},[])),r=(r||[]).map(t=>({start:Number(t.start),end:Number(t.end),text:n(t),_orig:t})).filter(t=>!Number.isNaN(t.start)&&!Number.isNaN(t.end)),s=(s||[]).map((t,e)=>({start:Number(t.start),end:Number(t.end),speaker:t.speaker||t.speaker_label||(void 0!==t.id?"SPK ".concat(t.id):"SPK ".concat(e)),_orig:t})).filter(t=>!Number.isNaN(t.start)&&!Number.isNaN(t.end)),{normalizedWords:r,normalizedSegments:s}}(t,e);return function(t,e){const r=[];let s={words:[],text:"",speaker:""};return t.forEach(t=>{const a=function(t,e){return e.find(e=>{if(t.start>=e.start&&t.end<=e.end)return e})}(t,e);a&&(s.words.length>0&&a.speaker===s.speaker?(s.words.push(t),s.text+="".concat(n(t)," ")):(s.words.length>0&&(s.text=s.text.trim(),r.push(s)),s={words:[t],text:"".concat(n(t)," "),speaker:a.speaker}))}),s.words.length>0&&(s.text=s.text.trim(),r.push(s)),r}(r,s)}}},e={};function r(n){var s=e[n];if(void 0!==s)return s.exports;var a=e[n]={exports:{}};return t[n](a,a.exports,r),a.exports}r.d=(t,e)=>{for(var n in e)r.o(e,n)&&!r.o(t,n)&&Object.defineProperty(t,n,{enumerable:!0,get:e[n]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var n={};r.r(n),r.d(n,{createEntityMap:()=>h,default:()=>y});var s=r(760);const a=(t,e)=>{for(const r in e){const n=e[r],s=parseFloat(t);if(s>=n.start&s<n.end)return n.name}return"UNK"},o=(t,e)=>{const r=parseFloat(t.start_time),n=parseFloat(t.end_time),s=e.find(t=>r>=parseFloat(t.start_time)&&n<=parseFloat(t.end_time));return void 0===s?"UKN":s.speaker_label.replace("spk_","")};function c(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,n)}return r}function p(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?c(Object(r),!0).forEach(function(e){i(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):c(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function i(t,e,r){return(e=function(t){var e=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const d=t=>/punctuation/.test(t.type)?Object.assign(t.alternatives[0],{confidence:1}):t.alternatives.reduce(function(t,e){return parseFloat(t.confidence)>parseFloat(e.confidence)?t:e}),l=t=>{const e=d(t);return{start:parseFloat(t.start_time),end:parseFloat(t.end_time),text:e.content,confidence:parseFloat(e.confidence)}},u=t=>{const e=[],r=t.results.items,n=t.results.speaker_labels,a=(t=>{const e=[];return t.map((r,n)=>{let s={};return"punctuation"===r.type?(e.push(n-1),s=t[n-1],((t,e)=>{const r=t.alternatives[0].content;return p(p({},e),{},{alternatives:e.alternatives.map(t=>{return p(p({},t),{},{content:t.content+(e=r,e.replace(/^\s/,""))});var e})})})(r,s)):r}).filter((t,r)=>!e.includes(r))})(r),c=void 0!==n?((t,e)=>((t,e)=>{const r=((t,e)=>t.map(t=>Object.assign(t,{speaker_label:o(t,e)})))(t,e.segments);return(t=>{const e=[];let r="";return t.forEach(t=>{t.speaker_label===r?e[e.length-1].words.push(t):(r=t.speaker_label,e.push({speaker:t.speaker_label,words:[t]}))}),e})(r)})(t,e).map(t=>({words:t.words.map(l),text:t.words.map(t=>d(t).content),speaker:t.speaker})))(a,n):(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{const n=d(t).content,s=l(t);/[.?!]/.test(n)?(r.words.push(s),r.text.push(n),e.push(r),r={words:[],text:[]}):(r.words.push(s),r.text.push(n))}),e})(a);return c.forEach((t,r)=>{const n={text:t.text.join(" "),type:"paragraph",data:{speaker:t.speaker?"Speaker ".concat(t.speaker):"TBC ".concat(r),words:t.words,start:parseFloat(t.words[0].start)},entityRanges:(0,s.A)(t.words,"text")};e.push(n)}),e};var f=r(2432);const m=t=>t.reduce((t,e)=>t.concat(Array.isArray(e)?m(e):e),[]),h=t=>{const e=t.map(t=>t.entityRanges),r=m(e),n={};return r.forEach(t=>{n[t.key]={type:"WORD",mutability:"MUTABLE",data:t}}),n},w=(t,e)=>{let r=parseFloat(t);return void 0!==e&&(r+=parseFloat(e/1e9)),r},g=t=>{const e=[];return(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{const n=(t=>0===t.alternatives.length?t[0]:t.alternatives.reduce(function(t,e){return parseFloat(t.confidence)>parseFloat(e.confidence)?t:e}))(t);r.text.push(n.transcript.trim()),n.words.forEach(t=>{var e,s;r.words.push((e=t,s=n.confidence,{start:w(e.startTime.seconds,e.startTime.nanos),end:w(e.endTime.seconds,e.endTime.nanos),text:e.word,confidence:s}))}),e.push(r),r={words:[],text:[]}}),e})(t.results).forEach((t,r)=>{const n={text:t.text.join(" "),type:"paragraph",data:{speaker:t.speaker?"Speaker ".concat(t.speaker):"TBC ".concat(r),words:t.words,start:parseFloat(t.words[0].start)},entityRanges:(0,s.A)(t.words,"text")};e.push(n)}),e},x=t=>{if(null==t)return;const e="string"==typeof t?parseFloat(t):t;return Number.isFinite(e)?e:void 0},y=(t,e)=>{let r;switch(e){case"bbckaldi":return r=(t=>{const e=[];let r,n=null,a=[];return void 0!==t.retval?(r=t.retval.words,void 0!==t.retval.segmentation&&(n=t.retval.segmentation)):(r=t.words,void 0!==t.segmentation&&(n=t.segmentation)),a=null===n?(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{/[.?!]/.test(t.punct)?(r.words.push(t),r.text.push(t.punct),r.text=r.text.join(" "),e.push(r),r={words:[],text:[]}):(r.words.push(t),r.text.push(t.punct))}),e})(r):function(t){let e=t[0].speaker;const r=[];let n={words:[],text:"",speaker:""};return t.forEach(t=>{e===t.speaker?(n.words.push(t),n.text+="".concat(t.punct," "),n.speaker=e):(e=t.speaker,n.text=n.text.trim(),r.push(n),n={words:[],text:"",speaker:"U_UKN"},n.words.push(t),n.text+="".concat(t.punct," "))}),r.push(n),r}(function(t,e){const r=[];return t.forEach(t=>{const n=function(t,e){const r=e.find(e=>{const r=e.start+e.duration;return t.start>=e.start&&t.end<=r});return void 0===r?{"@type":"Segment",speaker:{"@id":"UKN"}}:r}(t,e);t.speaker=n.speaker["@id"],r.push(t)}),r}(r,n.segments)),a.forEach((t,r)=>{if(void 0!==t.words[0]){let a="TBC ".concat(r);null!==n&&(a=t.speaker);const o={text:t.text,type:"paragraph",data:{speaker:a,words:t.words,start:t.words[0].start},entityRanges:(0,s.A)(t.words,"punct")};e.push(o)}}),e})(t),{blocks:r,entityMap:h(r)};case"autoedit2":return r=(t=>{const e=[];return(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{t.paragraph.forEach(t=>{t.line.forEach(t=>{const n={text:t.text,start:t.startTime,end:t.endTime};/[.?!]/.test(t.text)?(r.words.push(n),r.text.push(t.text),e.push(r),r={words:[],text:[]}):(r.words.push(n),r.text.push(t.text))})})}),e})(t.text).forEach((t,r)=>{const n={text:t.text.join(" "),type:"paragraph",data:{speaker:"TBC ".concat(r),words:t.words,start:t.words[0].start},entityRanges:(0,s.A)(t.words,"text")};e.push(n)}),e})(t),{blocks:r,entityMap:h(r)};case"speechmatics":return r=(t=>{const e=[];let r,n;r=(t=>{const e=[];return t.forEach(t=>{/[.?!]/.test(t.name)?(e[e.length-1].name=e[e.length-1].name+t.name,e[e.length-1].duration=(parseFloat(e[e.length-1].duration)+parseFloat(t.duration)).toString()):e.push(t)}),e})(t.words),r=r.map((t,e)=>({start:parseFloat(t.time),end:parseFloat(t.time)+parseFloat(t.duration),confidence:parseFloat(t.confidence),word:t.name.toLowerCase().replace(/[.?!]/g,""),punct:t.name,index:e})),n=t.speakers,n=n.map(t=>({start:parseFloat(t.time),end:parseFloat(t.time)+parseFloat(t.duration),name:t.name}));return((t,e)=>{const r=[];let n,s={words:[],text:[],speaker:""},o=a(t[0].start,e),c=!1;return t.forEach(t=>{n=a(t.start,e),(n!==o||s.words.length>150&&c)&&(s.speaker=o,r.push(s),o=n,s={words:[],text:[]}),s.words.push(t),s.text.push(t.punct),c=!!/[.?!]/.test(t.punct)}),s.speaker=o,r.push(s),r})(r,n).forEach(t=>{const r=t.words[0].start,n={text:t.text.join(" "),type:"paragraph",data:{speaker:t.speaker,words:t.words,start:r},entityRanges:(0,s.A)(t.words,"punct")};e.push(n)}),e})(t),{blocks:r,entityMap:h(r)};case"ibm":return r=(t=>{const e=[];return t.forEach(t=>{const r={text:t.map(t=>t.text).join(" "),type:"paragraph",data:{speaker:t[0].speaker,words:t,start:t[0].start},entityRanges:(0,s.A)(t,"text")};e.push(r)}),e})((o=(t=>{const e=[];return t.forEach(t=>{e.push(t.alternatives[0].timestamps.map(t=>({text:t[0],start:t[1],end:t[2]})))}),e})((n=t).results[0].results),c=n.results[0].speaker_labels,o.map(t=>t.map(t=>(t.speaker=((t,e)=>{const r=e.find(e=>{const r=e.from,n=e.to;return t.start===r&&t.end===n});return void 0===r?"UKN":"S_".concat(r.speaker)})(t,c),t))))),{blocks:r,entityMap:h(r)};case"draftjs":return t;case"amazontranscribe":return r=u(t),{blocks:r,entityMap:h(r)};case"digitalpaperedit":return r=(t=>{let e=[];const{words:r,paragraphs:n}=t;e=n?(0,f.default)(r,n):(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{r.words.push(t),r.text.push(t.text),/[.?!]/.test(t.text)&&(r.text=r.text.join(" "),e.push(r),r={words:[],text:[]})}),e})(r);return e.map((t,e)=>(t.speaker||(t.speaker="TBC ".concat(e)),(t=>{const{words:e,text:r,speaker:n}=t;return{text:r,type:"paragraph",data:{speaker:n,words:e,start:e.length>0?e[0].start:0},entityRanges:(0,s.A)(e,"text")}})(t)))})(t),{blocks:r,entityMap:h(r)};case"google-stt":return r=g(t),{blocks:r,entityMap:h(r)};case"whisper":return r=(t=>{const e=(t=>t?Array.isArray(t)?t:Array.isArray(t.segments)?t.segments:t.results&&Array.isArray(t.results.segments)?t.results.segments:[]:[])(t).map((t,e)=>{var r;const n=((t,e)=>{var r,n,s,a,o;if(Array.isArray(t.words)&&t.words.length>0)return t.words.map((e,r)=>{var n,s,a,o,c,p,i,d,l,u,f,m;const h=(null!==(n=null!==(s=e.word)&&void 0!==s?s:e.text)&&void 0!==n?n:"").toString().trim();if(!h)return null;const w=null!==(a=null!==(o=x(e.start))&&void 0!==o?o:x(e.start_time))&&void 0!==a?a:x(t.start),g=null!==(c=null!==(p=null!==(i=x(e.end))&&void 0!==i?i:x(e.end_time))&&void 0!==p?p:w)&&void 0!==c?c:x(t.end),y=null!==(d=null!==(l=x(e.probability))&&void 0!==l?l:x(e.confidence))&&void 0!==d?d:x(t.confidence);return{start:null!=w?w:0,end:null!==(u=null!=g?g:w)&&void 0!==u?u:0,confidence:null!=y?y:void 0,punct:h,word:h,text:h,speaker:null!==(f=null!==(m=e.speaker)&&void 0!==m?m:e.speaker_label)&&void 0!==f?f:t.speaker_label}}).filter(Boolean);const c=(null!==(r=t.text)&&void 0!==r?r:"").trim();if(!c)return[];const p=null!==(n=x(t.start))&&void 0!==n?n:0;return[{start:p,end:null!==(s=x(t.end))&&void 0!==s?s:p,confidence:null!==(a=x(t.confidence))&&void 0!==a?a:void 0,punct:c,word:c,text:c,speaker:null!==(o=t.speaker_label)&&void 0!==o?o:"TBC ".concat(e)}]})(t,e);if(!n.length)return null;const a=n.map(t=>t.punct).join(" ").trim(),o=null!==(r=n[0].start)&&void 0!==r?r:0;return{text:a,type:"paragraph",data:{speaker:t.speaker_label&&t.speaker_label.trim()||n[0].speaker&&n[0].speaker.trim()||"TBC ".concat(e),words:n,start:o},entityRanges:(0,s.A)(n,"punct")}}).filter(Boolean),r=[];for(let t=0;t<e.length;t++){const n=e[t];if(0===r.length||r[r.length-1].data.speaker!==n.data.speaker)r.push(n);else{const t=r[r.length-1];t.text="".concat(t.text," ").concat(n.text),t.data.words=[...t.data.words,...n.data.words],t.entityRanges=(0,s.A)(t.data.words,"punct")}}return r})(t),{blocks:r,entityMap:h(r)};default:console.error("Did not recognize the stt engine.")}var n,o,c};return n})());