!function(t,e){"object"==typeof exports&&"object"==typeof module?module.exports=e():"function"==typeof define&&define.amd?define([],e):"object"==typeof exports?exports.sttJsonAdapter=e():t.sttJsonAdapter=e()}(this,()=>(()=>{"use strict";var t={1114:(t,e,r)=>{r.d(e,{A:()=>n});const s=t=>t.reduce((t,e)=>t.concat(Array.isArray(e)?s(e):e),[]),n=t=>{const e=t.map(t=>t.entityRanges),r=s(e),n={};return r.forEach(t=>{n[t.key]={type:"WORD",mutability:"MUTABLE",data:t}}),n}},4129:(t,e,r)=>{r.d(e,{A:()=>s});const s=(t,e)=>{let r=0;return t.map(t=>{const s={start:t.start,end:t.end,confidence:t.confidence,text:t[e],offset:r,length:t[e].length,key:Math.random().toString(36).substring(6)};return r=r+t[e].length+1,s})}},7941:(t,e,r)=>{function s(t){const e=t&&(t.text||t.word||t.token||t.t||"");return String(e).trim()}r.d(e,{default:()=>n});const n=function(t,e){const{normalizedWords:r,normalizedSegments:n}=function(t,e){let r=Array.isArray(t)?t.slice():[],n=Array.isArray(e)?e.slice():[];return!n.length&&t&&t.segments&&(n=t.segments.slice(),r=[]),r&&0!==r.length||!n.length||n.some(t=>Array.isArray(t.words)&&t.words.length)&&(n=n.map(t=>{const e=t.speaker||t.speaker_label||(void 0!==t.id?`SPK ${t.id}`:"UKN");return Object.assign({},t,{speaker:e})}),r=n.reduce((t,e)=>{const r=(e.words||[]).map(t=>({start:t.start,end:t.end,text:s(t),_segment:e}));return t.concat(r)},[])),r=(r||[]).map(t=>({start:Number(t.start),end:Number(t.end),text:s(t),_orig:t})).filter(t=>!Number.isNaN(t.start)&&!Number.isNaN(t.end)),n=(n||[]).map((t,e)=>({start:Number(t.start),end:Number(t.end),speaker:t.speaker||t.speaker_label||(void 0!==t.id?`SPK ${t.id}`:`SPK ${e}`),_orig:t})).filter(t=>!Number.isNaN(t.start)&&!Number.isNaN(t.end)),{normalizedWords:r,normalizedSegments:n}}(t,e);return function(t,e){const r=[];let n={words:[],text:"",speaker:""};return t.forEach(t=>{const a=function(t,e){return e.find(e=>{if(t.start>=e.start&&t.end<=e.end)return e})}(t,e);a&&(n.words.length>0&&a.speaker===n.speaker?(n.words.push(t),n.text+=`${s(t)} `):(n.words.length>0&&(n.text=n.text.trim(),r.push(n)),n={words:[t],text:`${s(t)} `,speaker:a.speaker}))}),n.words.length>0&&(n.text=n.text.trim(),r.push(n)),r}(r,n)}}},e={};function r(s){var n=e[s];if(void 0!==n)return n.exports;var a=e[s]={exports:{}};return t[s](a,a.exports,r),a.exports}r.d=(t,e)=>{for(var s in e)r.o(e,s)&&!r.o(t,s)&&Object.defineProperty(t,s,{enumerable:!0,get:e[s]})},r.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),r.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})};var s={};r.r(s),r.d(s,{createEntityMap:()=>m.A,default:()=>x});var n=r(4129);const a=(t,e)=>{for(const r in e){const s=e[r],n=parseFloat(t);if(n>=s.start&n<s.end)return s.name}return"UNK"},o=(t,e)=>{const r=parseFloat(t.start_time),s=parseFloat(t.end_time),n=e.find(t=>r>=parseFloat(t.start_time)&&s<=parseFloat(t.end_time));return void 0===n?"UKN":n.speaker_label.replace("spk_","")};function p(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);e&&(s=s.filter(function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable})),r.push.apply(r,s)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?p(Object(r),!0).forEach(function(e){c(t,e,r[e])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):p(Object(r)).forEach(function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))})}return t}function c(t,e,r){return(e=function(t){var e=function(t){if("object"!=typeof t||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==typeof e?e:e+""}(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}const d=t=>/punctuation/.test(t.type)?Object.assign(t.alternatives[0],{confidence:1}):t.alternatives.reduce(function(t,e){return parseFloat(t.confidence)>parseFloat(e.confidence)?t:e}),u=t=>{const e=d(t);return{start:parseFloat(t.start_time),end:parseFloat(t.end_time),text:e.content,confidence:parseFloat(e.confidence)}},l=t=>{const e=[],r=t.results.items,s=t.results.speaker_labels,a=(t=>{const e=[];return t.map((r,s)=>{let n={};return"punctuation"===r.type?(e.push(s-1),n=t[s-1],((t,e)=>{const r=t.alternatives[0].content;return i(i({},e),{},{alternatives:e.alternatives.map(t=>{return i(i({},t),{},{content:t.content+(e=r,e.replace(/^\s/,""))});var e})})})(r,n)):r}).filter((t,r)=>!e.includes(r))})(r),p=void 0!==s?((t,e)=>((t,e)=>{const r=((t,e)=>t.map(t=>Object.assign(t,{speaker_label:o(t,e)})))(t,e.segments);return(t=>{const e=[];let r="";return t.forEach(t=>{t.speaker_label===r?e[e.length-1].words.push(t):(r=t.speaker_label,e.push({speaker:t.speaker_label,words:[t]}))}),e})(r)})(t,e).map(t=>({words:t.words.map(u),text:t.words.map(t=>d(t).content),speaker:t.speaker})))(a,s):(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{const s=d(t).content,n=u(t);/[.?!]/.test(s)?(r.words.push(n),r.text.push(s),e.push(r),r={words:[],text:[]}):(r.words.push(n),r.text.push(s))}),e})(a);return p.forEach((t,r)=>{const s={text:t.text.join(" "),type:"paragraph",data:{speaker:t.speaker?`Speaker ${t.speaker}`:`TBC ${r}`,words:t.words,start:parseFloat(t.words[0].start)},entityRanges:(0,n.A)(t.words,"text")};e.push(s)}),e};var f=r(7941);var m=r(1114);const h=(t,e)=>{let r=parseFloat(t);return void 0!==e&&(r+=parseFloat(e/1e9)),r},w=t=>{const e=[];return(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{const s=(t=>0===t.alternatives.length?t[0]:t.alternatives.reduce(function(t,e){return parseFloat(t.confidence)>parseFloat(e.confidence)?t:e}))(t);r.text.push(s.transcript.trim()),s.words.forEach(t=>{var e,n;r.words.push((e=t,n=s.confidence,{start:h(e.startTime.seconds,e.startTime.nanos),end:h(e.endTime.seconds,e.endTime.nanos),text:e.word,confidence:n}))}),e.push(r),r={words:[],text:[]}}),e})(t.results).forEach((t,r)=>{const s={text:t.text.join(" "),type:"paragraph",data:{speaker:t.speaker?`Speaker ${t.speaker}`:`TBC ${r}`,words:t.words,start:parseFloat(t.words[0].start)},entityRanges:(0,n.A)(t.words,"text")};e.push(s)}),e},g=t=>{if(null==t)return;const e="string"==typeof t?parseFloat(t):t;return Number.isFinite(e)?e:void 0},x=(t,e)=>{let r;switch(e){case"bbckaldi":return r=(t=>{const e=[];let r,s=null,a=[];return void 0!==t.retval?(r=t.retval.words,void 0!==t.retval.segmentation&&(s=t.retval.segmentation)):(r=t.words,void 0!==t.segmentation&&(s=t.segmentation)),a=null===s?(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{/[.?!]/.test(t.punct)?(r.words.push(t),r.text.push(t.punct),r.text=r.text.join(" "),e.push(r),r={words:[],text:[]}):(r.words.push(t),r.text.push(t.punct))}),e})(r):function(t){let e=t[0].speaker;const r=[];let s={words:[],text:"",speaker:""};return t.forEach(t=>{e===t.speaker?(s.words.push(t),s.text+=`${t.punct} `,s.speaker=e):(e=t.speaker,s.text=s.text.trim(),r.push(s),s={words:[],text:"",speaker:"U_UKN"},s.words.push(t),s.text+=`${t.punct} `)}),r.push(s),r}(function(t,e){const r=[];return t.forEach(t=>{const s=function(t,e){const r=e.find(e=>{const r=e.start+e.duration;return t.start>=e.start&&t.end<=r});return void 0===r?{"@type":"Segment",speaker:{"@id":"UKN"}}:r}(t,e);t.speaker=s.speaker["@id"],r.push(t)}),r}(r,s.segments)),a.forEach((t,r)=>{if(void 0!==t.words[0]){let a=`TBC ${r}`;null!==s&&(a=t.speaker);const o={text:t.text,type:"paragraph",data:{speaker:a,words:t.words,start:t.words[0].start},entityRanges:(0,n.A)(t.words,"punct")};e.push(o)}}),e})(t),{blocks:r,entityMap:(0,m.A)(r)};case"autoedit2":return r=(t=>{const e=[];return(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{t.paragraph.forEach(t=>{t.line.forEach(t=>{const s={text:t.text,start:t.startTime,end:t.endTime};/[.?!]/.test(t.text)?(r.words.push(s),r.text.push(t.text),e.push(r),r={words:[],text:[]}):(r.words.push(s),r.text.push(t.text))})})}),e})(t.text).forEach((t,r)=>{const s={text:t.text.join(" "),type:"paragraph",data:{speaker:`TBC ${r}`,words:t.words,start:t.words[0].start},entityRanges:(0,n.A)(t.words,"text")};e.push(s)}),e})(t),{blocks:r,entityMap:(0,m.A)(r)};case"speechmatics":return r=(t=>{const e=[];let r,s;r=(t=>{const e=[];return t.forEach(t=>{/[.?!]/.test(t.name)?(e[e.length-1].name=e[e.length-1].name+t.name,e[e.length-1].duration=(parseFloat(e[e.length-1].duration)+parseFloat(t.duration)).toString()):e.push(t)}),e})(t.words),r=r.map((t,e)=>({start:t.time,end:(parseFloat(t.time)+parseFloat(t.duration)).toString(),confidence:t.confidence,word:t.name.toLowerCase().replace(/[.?!]/g,""),punct:t.name,index:e})),s=t.speakers,s=s.map(t=>({start:parseFloat(t.time),end:parseFloat(t.time)+parseFloat(t.duration),name:t.name}));return((t,e)=>{const r=[];let s,n={words:[],text:[],speaker:""},o=a(t[0].start,e),p=!1;return t.forEach(t=>{s=a(t.start,e),(s!==o||n.words.length>150&&p)&&(n.speaker=o,r.push(n),o=s,n={words:[],text:[]}),n.words.push(t),n.text.push(t.punct),p=!!/[.?!]/.test(t.punct)}),n.speaker=o,r.push(n),r})(r,s).forEach(t=>{const r=t.words[0].start,s={text:t.text.join(" "),type:"paragraph",data:{speaker:t.speaker,words:t.words,start:r},entityRanges:(0,n.A)(t.words,"punct")};e.push(s)}),e})(t),{blocks:r,entityMap:(0,m.A)(r)};case"ibm":return r=(t=>{const e=[];return t.forEach(t=>{const r={text:t.map(t=>t.text).join(" "),type:"paragraph",data:{speaker:t[0].speaker,words:t,start:t[0].start},entityRanges:(0,n.A)(t,"text")};e.push(r)}),e})((o=(t=>{const e=[];return t.forEach(t=>{e.push(t.alternatives[0].timestamps.map(t=>({text:t[0],start:t[1],end:t[2]})))}),e})((s=t).results[0].results),p=s.results[0].speaker_labels,o.map(t=>t.map(t=>(t.speaker=((t,e)=>{const r=e.find(e=>{const r=e.from,s=e.to;return t.start===r&&t.end===s});return void 0===r?"UKN":`S_${r.speaker}`})(t,p),t))))),{blocks:r,entityMap:(0,m.A)(r)};case"draftjs":return t;case"amazontranscribe":return r=l(t),{blocks:r,entityMap:(0,m.A)(r)};case"digitalpaperedit":return r=(t=>{let e=[];const{words:r,paragraphs:s}=t;e=s?(0,f.default)(r,s):(t=>{const e=[];let r={words:[],text:[]};return t.forEach(t=>{r.words.push(t),r.text.push(t.text),/[.?!]/.test(t.text)&&(r.text=r.text.join(" "),e.push(r),r={words:[],text:[]})}),e})(r);return e.map((t,e)=>(t.speaker||(t.speaker=`TBC ${e}`),(t=>{const{words:e,text:r,speaker:s}=t;return{text:r,type:"paragraph",data:{speaker:s,words:e,start:e.length>0?e[0].start:0},entityRanges:(0,n.A)(e,"text")}})(t)))})(t),{blocks:r,entityMap:(0,m.A)(r)};case"google-stt":return r=w(t),{blocks:r,entityMap:(0,m.A)(r)};case"whisper":return r=(t=>{const e=(t=>t?Array.isArray(t)?t:Array.isArray(t.segments)?t.segments:t.results&&Array.isArray(t.results.segments)?t.results.segments:[]:[])(t).map((t,e)=>{const r=((t,e)=>{if(Array.isArray(t.words)&&t.words.length>0)return t.words.map((e,r)=>{const s=(e.word??e.text??"").toString().trim();if(!s)return null;const n=g(e.start)??g(e.start_time)??g(t.start);return{start:n??0,end:g(e.end)??g(e.end_time)??n??g(t.end)??n??0,confidence:g(e.probability)??g(e.confidence)??g(t.confidence)??void 0,punct:s,word:s,text:s,speaker:e.speaker??e.speaker_label??t.speaker_label}}).filter(Boolean);const r=(t.text??"").trim();if(!r)return[];const s=g(t.start)??0;return[{start:s,end:g(t.end)??s,confidence:g(t.confidence)??void 0,punct:r,word:r,text:r,speaker:t.speaker_label??`TBC ${e}`}]})(t,e);if(!r.length)return null;const s=r.map(t=>t.punct).join(" ").trim(),a=r[0].start??0;return{text:s,type:"paragraph",data:{speaker:t.speaker_label&&t.speaker_label.trim()||r[0].speaker&&r[0].speaker.trim()||`TBC ${e}`,words:r,start:a},entityRanges:(0,n.A)(r,"punct")}}).filter(Boolean),r=[];for(let t=0;t<e.length;t++){const s=e[t];if(0===r.length||r[r.length-1].data.speaker!==s.data.speaker)r.push(s);else{const t=r[r.length-1];t.text=t.text+" "+s.text,t.data.words=[...t.data.words,...s.data.words],t.entityRanges=(0,n.A)(t.data.words,"punct")}}return r})(t),{blocks:r,entityMap:(0,m.A)(r)};default:console.error("Did not recognize the stt engine.")}var s,o,p};return s})());